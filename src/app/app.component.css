/* ✅ OPTIMIZACIÓN GLOBAL - Sin !important */

/* Galaxy - Máxima performance */
app-galaxy {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1;
  pointer-events: none;
  
  /* ✅ Performance crítica */
  contain: layout style paint size;
  will-change: auto; /* Solo cuando necesario */
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

/* Particles - Optimizadas para scroll */
.particles-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 5;
  pointer-events: none;
  
  /* ✅ Optimización scroll brusco */
  contain: layout style paint size;
  will-change: opacity, transform;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  
  /* ✅ Transición más rápida para scroll */
  transition: opacity 0.2s ease-out;
  isolation: isolate;
}

/* Content wrapper optimizado */
.content-wrapper {
  position: relative;
  z-index: 10;
  background: transparent;
  
  /* ✅ Performance durante scroll */
  contain: layout style;
  transform: translate3d(0, 0, 0);
}

/* Secciones súper optimizadas */
.section-container {
  position: relative;
  width: 100%;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 15;
  
  /* ✅ CRÍTICO: Optimización scroll brusco */
  contain: layout style paint size;
  will-change: auto; /* Solo cuando sea necesario */
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  
  /* ✅ Sin transición durante scroll rápido */
  transition: none;
  isolation: isolate;
}

/* Header optimizado */
.header-fixed {
  position: relative;
  z-index: 50;
  
  /* ✅ Performance */
  contain: layout style paint;
  transform: translate3d(0, 0, 0);
}

/* ✅ NUEVO: Optimización durante scroll */
.scrolling .particles-layer {
  opacity: 0.2;
  will-change: opacity; /* Activar solo durante scroll */
  transition: opacity 0.1s ease-out;
}

.scrolling .section-container {
  contain: layout style;
  will-change: auto; /* Desactivar durante scroll */
}

.scrolling app-galaxy {
  will-change: auto; /* Parar animaciones durante scroll */
}

/* Estados contextuales optimizados */
:host-context(.header-active) .particles-layer {
  opacity: 0.5;
  transition: opacity 0.15s ease-out;
}

:host-context(.cursor-targeting) .particles-layer {
  opacity: 0.7;
  transition: opacity 0.1s ease-out;
}

/* Loader sin !important */
app-elegant-loader {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 10000;
  
  opacity: 1;
  visibility: visible;
  
  transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
  
  transform: translate3d(0, 0, 0);
  will-change: opacity, visibility;
  contain: layout style paint;
  backface-visibility: hidden;
}

app-elegant-loader.loader-hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}

/* ✅ RESPONSIVE optimizado */
@media (max-width: 768px) {
  .particles-layer {
    opacity: 0.4; /* Menos intenso en móvil */
    will-change: auto; /* Menos will-change en móvil */
  }
  
  .section-container {
    min-height: 100vh;
    padding: 1rem;
    contain: layout style; /* Menos containment en móvil */
  }
  
  app-galaxy {
    will-change: auto; /* Sin will-change en móvil */
  }
}

@media (max-width: 480px) {
  .particles-layer {
    opacity: 0.3;
    transform: scale(0.95) translate3d(0, 0, 0); /* Menos complejo */
  }
}

/* ✅ PERFORMANCE: Reducir efectos durante scroll rápido */
@media (prefers-reduced-motion: reduce) {
  .particles-layer {
    display: none;
  }
  
  .content-wrapper,
  .section-container {
    transition: none;
    animation: none;
  }
  
  app-galaxy {
    display: none; /* Eliminar en reduced motion */
  }
}

@media (prefers-contrast: high) {
  .particles-layer {
    opacity: 0.1;
  }
}

@media (prefers-reduced-data: reduce) {
  .particles-layer,
  app-galaxy {
    display: none;
  }
}

/* ✅ MÓVIL: Loader más rápido */
@media (max-width: 1023px) {
  app-elegant-loader {
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
  }
  
  .particles-layer {
    opacity: 0.2; /* Mucho menos intenso */
  }
}

.section-skeleton {
  width: 100%;
  max-width: 1200px;
  padding: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2rem;
  opacity: 0.8;
}

/* Base skeleton animation */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* ✅ Base skeleton class - SIN @extend */
.skeleton-header,
.skeleton-line,
.skeleton-avatar,
.skeleton-card,
.skeleton-skill,
.skeleton-input,
.skeleton-textarea,
.skeleton-button {
  background: linear-gradient(
    90deg,
    rgba(31, 41, 55, 0.6) 25%,
    rgba(55, 65, 81, 0.8) 50%,
    rgba(31, 41, 55, 0.6) 75%
  );
  background-size: 200% 100%;
  animation: shimmer 2s infinite ease-in-out;
  border-radius: 8px;
}

/* Header skeleton */
.skeleton-header {
  width: 300px;
  height: 60px;
  margin-bottom: 2rem;
}

/* Content skeletons */
.skeleton-content {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  width: 100%;
  max-width: 600px;
}

.skeleton-line {
  height: 20px;
  width: 100%;
}

.skeleton-line.medium {
  width: 75%;
}

.skeleton-line.short {
  width: 50%;
}

/* Avatar skeleton */
.skeleton-avatar {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  margin-bottom: 1rem;
}

/* Projects grid skeleton */
.projects-skeleton {
  gap: 3rem;
}

.skeleton-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  width: 100%;
}

.skeleton-card {
  height: 250px;
  border-radius: 12px;
}

/* Skills skeleton */
.skeleton-skills {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  width: 100%;
  max-width: 800px;
}

.skeleton-skill {
  height: 80px;
  border-radius: 8px;
}

/* Form skeleton */
.skeleton-form {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  width: 100%;
  max-width: 500px;
}

.skeleton-input {
  height: 50px;
}

.skeleton-textarea {
  height: 120px;
}

.skeleton-button {
  height: 50px;
  width: 150px;
  align-self: center;
}

/* Footer skeleton */
.footer-skeleton {
  padding: 2rem;
  display: flex;
  justify-content: center;
}

.skeleton-footer-content {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  align-items: center;
}

/* ✅ MÓVIL: Skeletons más simples */
@media (max-width: 768px) {
  .section-skeleton {
    padding: 1rem;
    gap: 1.5rem;
  }
  
  .skeleton-header {
    width: 250px;
    height: 40px;
  }
  
  .skeleton-grid {
    grid-template-columns: 1fr;
  }
  
  .skeleton-skills {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ✅ PERFORMANCE: Reducir animación en móvil */
@media (max-width: 480px) {
  @keyframes shimmer {
    0% { opacity: 0.6; }
    50% { opacity: 0.8; }
    100% { opacity: 0.6; }
  }
  
  .skeleton-base {
    animation: shimmer 3s infinite ease-in-out;
  }
}

/* ✅ ACCESSIBILITY */
@media (prefers-reduced-motion: reduce) {
  .skeleton-base {
    animation: none;
    background: rgba(31, 41, 55, 0.7);
  }
}
