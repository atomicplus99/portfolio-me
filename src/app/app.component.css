/* ✅ OPTIMIZACIÓN GLOBAL - Sin !important */

/* Galaxy - Máxima performance */
app-galaxy {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1;
  pointer-events: none;
  
  /* ✅ Performance crítica */
  contain: layout style paint size;
  will-change: auto; /* Solo cuando necesario */
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

/* Particles - Optimizadas para scroll */
.particles-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 5;
  pointer-events: none;
  
  /* ✅ Optimización scroll brusco */
  contain: layout style paint size;
  will-change: opacity, transform;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  
  /* ✅ Transición más rápida para scroll */
  transition: opacity 0.2s ease-out;
  isolation: isolate;
}

/* Content wrapper optimizado */
.content-wrapper {
  position: relative;
  z-index: 10;
  background: transparent;
  
  /* ✅ Performance durante scroll */
  contain: layout style;
  transform: translate3d(0, 0, 0);
}

/* Secciones súper optimizadas */
.section-container {
  position: relative;
  width: 100%;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 15;
  
  /* ✅ CRÍTICO: Optimización scroll brusco */
  contain: layout style paint size;
  will-change: auto; /* Solo cuando sea necesario */
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  
  /* ✅ Sin transición durante scroll rápido */
  transition: none;
  isolation: isolate;
}

/* Header optimizado */
.header-fixed {
  position: relative;
  z-index: 50;
  
  /* ✅ Performance */
  contain: layout style paint;
  transform: translate3d(0, 0, 0);
}

/* ✅ NUEVO: Optimización durante scroll */
.scrolling .particles-layer {
  opacity: 0.2;
  will-change: opacity; /* Activar solo durante scroll */
  transition: opacity 0.1s ease-out;
}

.scrolling .section-container {
  contain: layout style;
  will-change: auto; /* Desactivar durante scroll */
}

.scrolling app-galaxy {
  will-change: auto; /* Parar animaciones durante scroll */
}

/* Estados contextuales optimizados */
:host-context(.header-active) .particles-layer {
  opacity: 0.5;
  transition: opacity 0.15s ease-out;
}

:host-context(.cursor-targeting) .particles-layer {
  opacity: 0.7;
  transition: opacity 0.1s ease-out;
}

/* Loader sin !important */
app-elegant-loader {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 10000;
  
  opacity: 1;
  visibility: visible;
  
  transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
  
  transform: translate3d(0, 0, 0);
  will-change: opacity, visibility;
  contain: layout style paint;
  backface-visibility: hidden;
}

app-elegant-loader.loader-hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}

/* ✅ RESPONSIVE optimizado */
@media (max-width: 768px) {
  .particles-layer {
    opacity: 0.4; /* Menos intenso en móvil */
    will-change: auto; /* Menos will-change en móvil */
  }
  
  .section-container {
    min-height: 100vh;
    padding: 1rem;
    contain: layout style; /* Menos containment en móvil */
  }
  
  app-galaxy {
    will-change: auto; /* Sin will-change en móvil */
  }
}

@media (max-width: 480px) {
  .particles-layer {
    opacity: 0.3;
    transform: scale(0.95) translate3d(0, 0, 0); /* Menos complejo */
  }
}

/* ✅ PERFORMANCE: Reducir efectos durante scroll rápido */
@media (prefers-reduced-motion: reduce) {
  .particles-layer {
    display: none;
  }
  
  .content-wrapper,
  .section-container {
    transition: none;
    animation: none;
  }
  
  app-galaxy {
    display: none; /* Eliminar en reduced motion */
  }
}

@media (prefers-contrast: high) {
  .particles-layer {
    opacity: 0.1;
  }
}

@media (prefers-reduced-data: reduce) {
  .particles-layer,
  app-galaxy {
    display: none;
  }
}

/* ✅ MÓVIL: Loader más rápido */
@media (max-width: 1023px) {
  app-elegant-loader {
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
  }
  
  .particles-layer {
    opacity: 0.2; /* Mucho menos intenso */
  }
}