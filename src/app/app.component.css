.particles-layer {
 position: fixed;
 top: 0;
 left: 0;
 width: 100vw;
 height: 100vh;
 z-index: 5; /* ✅ MANTENER - Necesario para que las partículas estén detrás del contenido */
 pointer-events: none;
 transition: opacity 0.4s ease-out;
 transform: translateZ(0);
 will-change: transform, opacity;
 contain: layout style paint;
 isolation: isolate;
}

.section-container {
 position: relative;
 width: 100%;
 min-height: 100vh;
 display: flex;
 align-items: center;
 justify-content: center;
 /* ❌ ELIMINADO: z-index: 10; - Ya no necesario con *ngIf */
 transition: opacity 0.3s ease-out;
 
 /* ❌ ELIMINADO: opacity: 1 !important; - Ya no necesario */
 /* ❌ ELIMINADO: visibility: visible !important; - Ya no necesario */
 
 contain: layout style paint;
 isolation: isolate;
}

.header-fixed {
 position: relative;
 z-index: 50; /* ⚠️ EVALUAR - Mantener solo si el header se superpone con partículas */
}

/* ✅ MANTENER - Estados contextuales para interactividad */
:host-context(.header-active) .particles-layer {
 opacity: 0.5;
 transition: opacity 0.2s ease-out;
}

:host-context(.cursor-targeting) .particles-layer {
 opacity: 0.7;
 transition: opacity 0.1s ease-out;
}

:host-context(.scrolling) .particles-layer {
 opacity: 0.4;
 transition: opacity 0.1s ease-out;
}

:host-context(.scrolling) .section-container {
 contain: layout style;
}

/* ✅ MANTENER - Responsive design */
@media (max-width: 768px) {
 .particles-layer {
   opacity: 0.6;
 }
 
 .section-container {
   min-height: 100vh;
   padding: 1rem;
   contain: layout style;
 }
}

@media (max-width: 480px) {
 .particles-layer {
   opacity: 0.4;
 }
}

@media (max-width: 768px) and (max-height: 1024px) {
 .particles-layer {
   opacity: 0.3;
   transform: scale(0.9);
 }
}

/* ✅ MANTENER - Accesibilidad crítica */
@media (prefers-reduced-motion: reduce) {
 .particles-layer {
   display: none !important;
 }
 
 .content-wrapper,
 .section-container {
   transition: none !important;
   animation: none !important;
 }
}

@media (prefers-contrast: high) {
 .particles-layer {
   opacity: 0.2 !important;
 }
}

@media (prefers-reduced-data: reduce) {
 .particles-layer {
   display: none !important;
 }
}

app-galaxy {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1; /* ✅ Muy bajo, detrás del contenido */
  pointer-events: none;
}

/* ✅ Content wrapper encima de galaxy */
.content-wrapper {
  position: relative;
  z-index: 10; /* ✅ Encima de galaxy */
  background: transparent; /* Para que se vea galaxy detrás */
}

/* ✅ Asegurar que las secciones estén encima */
.section-container {
  position: relative;
  width: 100%;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 15; /* ✅ Encima del content-wrapper */
  transition: opacity 0.3s ease-out;
  contain: layout style paint;
  isolation: isolate;
}

/* ✅ Header encima de todo */
.header-fixed {
  position: relative;
  z-index: 50; /* ✅ Encima de todo para navegación */
}

/* ✅ Particles layer ajustado */
.particles-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 5; /* ✅ Entre galaxy y contenido */
  pointer-events: none;
  transition: opacity 0.4s ease-out;
  transform: translateZ(0);
  will-change: transform, opacity;
  contain: layout style paint;
  isolation: isolate;
}

/* Loader siempre visible inicialmente */
app-elegant-loader {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  z-index: 10000 !important;
  
  /* ✅ CRÍTICO: Visible por defecto */
  opacity: 1 !important;
  visibility: visible !important;
  
  /* ✅ Transición suave */
  transition: opacity 0.8s ease-out, visibility 0.8s ease-out !important;
  
  /* ✅ Performance móvil */
  transform: translate3d(0, 0, 0) !important;
  will-change: opacity, visibility !important;
  contain: layout style paint !important;
  backface-visibility: hidden !important;
}

/* Estado oculto del loader */
app-elegant-loader.loader-hidden {
  opacity: 0 !important;
  visibility: hidden !important;
  pointer-events: none !important;
}

/* ✅ CORREGIDO: Content wrapper normal por defecto */
.content-wrapper {
  opacity: 1;
  visibility: visible;
  transition: opacity 0.6s ease-in, visibility 0.6s ease-in;
}

/* MÓVIL: Solo transiciones del loader más rápidas */
@media (max-width: 1023px) {
  app-elegant-loader {
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out !important;
  }
}